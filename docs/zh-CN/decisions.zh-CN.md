# 设计决策记录（Decision Log）

> 记录项目中比较重要的设计选择，以及当时的原因。  
> 小改小动（比如变量名微调）不在这里记。

---

## 2025-12-02：统一使用 number 类型 ID

**类型**：数据模型 / 约定  
**结论**：所有 ID（`Item.id` / `Recipe.id` / `resultItemId` / `materials[].itemId`）统一使用 `number` 类型，而不是字符串形式的数字。

**原因**：
- 上游数据源（FF14 API / Wiki 等）大多使用数字 ID，映射时不需要频繁做类型转换。
- 方便在代码中使用 `Map<number, Item>` 等结构，避免 string/number 混用导致的 bug。
- 当前项目仍处于早期阶段，在此时统一规范，可以避免后续进行成本较大的迁移。

**影响**：
- 清洗外部数据时，如果源数据为字符串 ID，需要在导入时显式转换为 number。
- 前端代码中禁止使用 `"4421"` 这类字符串 ID 作为内部约定。

**状态**：有效

---

## 2025-12-02：拆分 Item 与 Recipe 两类实体

**类型**：数据模型 / 架构  
**结论**：将游戏数据拆分为两类实体：
- `Item`：只描述物品本身的信息（名称、是否为水晶、获取方式等）。
- `Recipe`：只描述一次制作行为（“用哪些材料 → 产出哪个成品”）。

**原因**：
- 让 `Recipe` 结构保持瘦且稳定，未来扩展 `Item` 信息时不需要修改所有配方。
- 配方树计算逻辑只依赖 ID 关系（`resultItemId` 和 `materials[].itemId`），降低耦合度。
- 便于在 `Item` 上逐步增加字段（采集点、NPC、分类等），而不让 `Recipe` 变得臃肿。

**影响**：
- 数据清洗脚本在导入时需要分别生成 `items.json` 与 `recipes.json`。
- 前端在展示配方时，需要通过 `itemId` 去 `Item` 表查物品信息，不再从 `Recipe` 中直接读取名称等属性。

**状态**：有效
